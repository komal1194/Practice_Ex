(function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=r.slice,o=r.unshift,u=i.toString,a=i.hasOwnProperty,f=r.forEach,l=r.map,c=r.reduce,h=r.reduceRight,p=r.filter,d=r.every,v=r.some,m=r.indexOf,g=r.lastIndexOf;i=Array.isArray;var y=Object.keys,b=Function.prototype.bind,w=function(e){return new N(e)};typeof module!=="undefined"&&module.exports?(module.exports=w,w._=w):e._=w;w.VERSION="1.1.6";var E=w.each=w.forEach=function(e,t,r){if(e!=null)if(f&&e.forEach===f)e.forEach(t,r);else if(w.isNumber(e.length))for(var i=0,s=e.length;i<s;i++){if(t.call(r,e[i],i,e)===n)break}else for(i in e)if(a.call(e,i)&&t.call(r,e[i],i,e)===n)break};w.map=function(e,t,n){var r=[];if(e==null)return r;if(l&&e.map===l)return e.map(t,n);E(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)});return r};w.reduce=w.foldl=w.inject=function(e,t,n,r){var i=n!==void 0;e==null&&(e=[]);if(c&&e.reduce===c)return r&&(t=w.bind(t,r)),i?e.reduce(t,n):e.reduce(t);E(e,function(e,s,o){!i&&s===0?(n=e,i=!0):n=t.call(r,n,e,s,o)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n};w.reduceRight=w.foldr=function(e,t,n,r){e==null&&(e=[]);if(h&&e.reduceRight===h)return r&&(t=w.bind(t,r)),n!==void 0?e.reduceRight(t,n):e.reduceRight(t);e=(w.isArray(e)?e.slice():w.toArray(e)).reverse();return w.reduce(e,t,n,r)};w.find=w.detect=function(e,t,n){var r;S(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0});return r};w.filter=w.select=function(e,t,n){var r=[];if(e==null)return r;if(p&&e.filter===p)return e.filter(t,n);E(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)});return r};w.reject=function(e,t,n){var r=[];if(e==null)return r;E(e,function(e,i,s){t.call(n,e,i,s)||(r[r.length]=e)});return r};w.every=w.all=function(e,t,r){var i=!0;if(e==null)return i;if(d&&e.every===d)return e.every(t,r);E(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n});return i};var S=w.some=w.any=function(e,t,r){t||(t=w.identity);var i=!1;if(e==null)return i;if(v&&e.some===v)return e.some(t,r);E(e,function(e,s,o){if(i=t.call(r,e,s,o))return n});return i};w.include=w.contains=function(e,t){var n=!1;if(e==null)return n;if(m&&e.indexOf===m)return e.indexOf(t)!=-1;S(e,function(e){if(n=e===t)return!0});return n};w.invoke=function(e,t){var n=s.call(arguments,2);return w.map(e,function(e){return(t.call?t||e:e[t]).apply(e,n)})};w.pluck=function(e,t){return w.map(e,function(e){return e[t]})};w.max=function(e,t,n){if(!t&&w.isArray(e))return Math.max.apply(Math,e);var r={computed:-Infinity};E(e,function(e,i,s){i=t?t.call(n,e,i,s):e;i>=r.computed&&(r={value:e,computed:i})});return r.value};w.min=function(e,t,n){if(!t&&w.isArray(e))return Math.min.apply(Math,e);var r={computed:Infinity};E(e,function(e,i,s){i=t?t.call(n,e,i,s):e;i<r.computed&&(r={value:e,computed:i})});return r.value};w.sortBy=function(e,t,n){return w.pluck(w.map(e,function(e,r,i){return{value:e,criteria:t.call(n,e,r,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:n>r?1:0}),"value")};w.sortedIndex=function(e,t,n){n||(n=w.identity);for(var r=0,i=e.length;r<i;){var s=r+i>>1;n(e[s])<n(t)?r=s+1:i=s}return r};w.toArray=function(e){if(!e)return[];if(e.toArray)return e.toArray();if(w.isArray(e))return e;if(w.isArguments(e))return s.call(e);return w.values(e)};w.size=function(e){return w.toArray(e).length};w.first=w.head=function(e,t,n){return t!=null&&!n?s.call(e,0,t):e[0]};w.rest=w.tail=function(e,t,n){return s.call(e,t==null||n?1:t)};w.last=function(e){return e[e.length-1]};w.compact=function(e){return w.filter(e,function(e){return!!e})};w.flatten=function(e){return w.reduce(e,function(e,t){if(w.isArray(t))return e.concat(w.flatten(t));e[e.length]=t;return e},[])};w.without=function(e){var t=s.call(arguments,1);return w.filter(e,function(e){return!w.include(t,e)})};w.uniq=w.unique=function(e,t){return w.reduce(e,function(e,n,r){if(0==r||(t===!0?w.last(e)!=n:!w.include(e,n)))e[e.length]=n;return e},[])};w.intersect=function(e){var t=s.call(arguments,1);return w.filter(w.uniq(e),function(e){return w.every(t,function(t){return w.indexOf(t,e)>=0})})};w.zip=function(){for(var e=s.call(arguments),t=w.max(w.pluck(e,"length")),n=Array(t),r=0;r<t;r++)n[r]=w.pluck(e,""+r);return n};w.indexOf=function(e,t,n){if(e==null)return-1;var r;if(n)return n=w.sortedIndex(e,t),e[n]===t?n:-1;if(m&&e.indexOf===m)return e.indexOf(t);n=0;for(r=e.length;n<r;n++)if(e[n]===t)return n;return-1};w.lastIndexOf=function(e,t){if(e==null)return-1;if(g&&e.lastIndexOf===g)return e.lastIndexOf(t);for(var n=e.length;n--;)if(e[n]===t)return n;return-1};w.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0);n=arguments[2]||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=Array(r);i<r;)s[i++]=e,e+=n;return s};w.bind=function(e,t){if(e.bind===b&&b)return b.apply(e,s.call(arguments,1));var n=s.call(arguments,2);return function(){return e.apply(t,n.concat(s.call(arguments)))}};w.bindAll=function(e){var t=s.call(arguments,1);t.length==0&&(t=w.functions(e));E(t,function(t){e[t]=w.bind(e[t],e)});return e};w.memoize=function(e,t){var n={};t||(t=w.identity);return function(){var r=t.apply(this,arguments);return a.call(n,r)?n[r]:n[r]=e.apply(this,arguments)}};w.delay=function(e,t){var n=s.call(arguments,2);return setTimeout(function(){return e.apply(e,n)},t)};w.defer=function(e){return w.delay.apply(w,[e,1].concat(s.call(arguments,1)))};var x=function(e,t,n){var r;return function(){var i=this,s=arguments,o=function(){r=null;e.apply(i,s)};n&&clearTimeout(r);if(n||!r)r=setTimeout(o,t)}};w.throttle=function(e,t){return x(e,t,!1)};w.debounce=function(e,t){return x(e,t,!0)};w.once=function(e){var t=!1,n;return function(){if(t)return n;t=!0;return n=e.apply(this,arguments)}};w.wrap=function(e,t){return function(){var n=[e].concat(s.call(arguments));return t.apply(this,n)}};w.compose=function(){var e=s.call(arguments);return function(){for(var t=s.call(arguments),n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}};w.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}};w.keys=y||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[],n;for(n in e)a.call(e,n)&&(t[t.length]=n);return t};w.values=function(e){return w.map(e,w.identity)};w.functions=w.methods=function(e){return w.filter(w.keys(e),function(t){return w.isFunction(e[t])}).sort()};w.extend=function(e){E(s.call(arguments,1),function(t){for(var n in t)t[n]!==void 0&&(e[n]=t[n])});return e};w.defaults=function(e){E(s.call(arguments,1),function(t){for(var n in t)e[n]==null&&(e[n]=t[n])});return e};w.clone=function(e){return w.isArray(e)?e.slice():w.extend({},e)};w.tap=function(e,t){t(e);return e};w.isEqual=function(e,t){if(e===t)return!0;var n=typeof e;if(n!=typeof t)return!1;if(e==t)return!0;if(!e&&t||e&&!t)return!1;if(e._chain)e=e._wrapped;if(t._chain)t=t._wrapped;if(e.isEqual)return e.isEqual(t);if(w.isDate(e)&&w.isDate(t))return e.getTime()===t.getTime();if(w.isNaN(e)&&w.isNaN(t))return!1;if(w.isRegExp(e)&&w.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.ignoreCase===t.ignoreCase&&e.multiline===t.multiline;if(n!=="object")return!1;if(e.length&&e.length!==t.length)return!1;n=w.keys(e);var r=w.keys(t);if(n.length!=r.length)return!1;for(var i in e)if(!(i in t)||!w.isEqual(e[i],t[i]))return!1;return!0};w.isEmpty=function(e){if(w.isArray(e)||w.isString(e))return e.length===0;for(var t in e)if(a.call(e,t))return!1;return!0};w.isElement=function(e){return!!(e&&e.nodeType==1)};w.isArray=i||function(e){return u.call(e)==="[object Array]"};w.isArguments=function(e){return!(!e||!a.call(e,"callee"))};w.isFunction=function(e){return!(!e||!e.constructor||!e.call||!e.apply)};w.isString=function(e){return!!(e===""||e&&e.charCodeAt&&e.substr)};w.isNumber=function(e){return!!(e===0||e&&e.toExponential&&e.toFixed)};w.isNaN=function(e){return e!==e};w.isBoolean=function(e){return e===!0||e===!1};w.isDate=function(e){return!(!e||!e.getTimezoneOffset||!e.setUTCFullYear)};w.isRegExp=function(e){return!(!e||!e.test||!e.exec||!(e.ignoreCase||e.ignoreCase===!1))};w.isNull=function(e){return e===null};w.isUndefined=function(e){return e===void 0};w.noConflict=function(){e._=t;return this};w.identity=function(e){return e};w.times=function(e,t,n){for(var r=0;r<e;r++)t.call(n,r)};w.mixin=function(e){E(w.functions(e),function(t){k(t,w[t]=e[t])})};var T=0;w.uniqueId=function(e){var t=T++;return e?e+t:t};w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};w.template=function(e,t){var n=w.templateSettings;n="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+e.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(n.interpolate,function(e,t){return"',"+t.replace(/\\'/g,"'")+",'"}).replace(n.evaluate||null,function(e,t){return"');"+t.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";n=new Function("obj",n);return t?n(t):n};var N=function(e){this._wrapped=e};w.prototype=N.prototype;var C=function(e,t){return t?w(e).chain():e},k=function(e,t){N.prototype[e]=function(){var e=s.call(arguments);o.call(e,this._wrapped);return C(t.apply(w,e),this._chain)}};w.mixin(w);E(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];N.prototype[e]=function(){t.apply(this._wrapped,arguments);return C(this._wrapped,this._chain)}});E(["concat","join","slice"],function(e){var t=r[e];N.prototype[e]=function(){return C(t.apply(this._wrapped,arguments),this._chain)}});N.prototype.chain=function(){this._chain=!0;return this};N.prototype.value=function(){return this._wrapped}})();(function(){var e,t,n,r,i,s,o=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(e,t,n){this.el=e;this.position=t;this.collection=n;this.el=$(this.el);this.width=this.el.width();this.height=this.el.height();this.src=this.el.attr("src");this.title=this.el.attr("title");this.target=this.el.data("cg-url");this.targets=this.el.data("title");this.midpoint=this.width/2;this.tpl_nav=$("#tpl-feature-nav").html();this.nav_container=$("#feature-nav-shim");e=new Date;this.id="fn-"+this.src.replace(/[^A-Za-z0-9_]/g,"");this.id+=e.getMilliseconds();this.build_nav()}e.prototype.build_nav=function(){var e,t;e="";t=_.template(this.tpl_nav);e+=t({nav:this.id});this.nav_container.append(e);this.nav_el=$("#"+this.id);return this.nav_el.click(o(function(e){e.preventDefault();return this.nav_to(this.id)},this))};e.prototype.toggle=function(){var e,t,n,r;e=/feature_nav_off/g;t=/feature_nav_on/g;n=this.nav_el.attr("src");if(e.test(n))n=n.replace(e,"feature_nav_on");else if(t.test(n))n=n.replace(t,"feature_nav_off");return this.nav_el.attr({src:n})};e.prototype.nav_to=function(e){this.collection.cycle_state=false;return _.each(this.collection.items,o(function(t,n){if(t.id===e){this.collection.position=n;return this.collection.center()}},this))};return e}();t=function(){function t(e){this.image_class=e;this.cycle_stop=o(this.cycle_stop,this);this.cycle_loop=o(this.cycle_loop,this);this.cycle_start=o(this.cycle_start,this);this.easing="easeInQuint";this.animation_pause=this.animation_time=0;this.window_width=$(window).width();this.position=0;this.items=[];this.nav_container=$("#feature-nav-shim");this.hotspot_container=$("#feature-hotspot");this.hotspot=this.hotspot_container.find("a");this.hotspots=this.hotspot_container.find("a img");this.ie7=false}t.prototype.init=function(){var t,n;this.images=$(this.image_class);this.parent=this.images.parent();this.images.each(o(function(t,n){return this.items.push(new e(n,t,this))},this));this.nav_container.css({width:this.items.length*18});this.items[this.position].toggle();this.hotspot.attr("href",this.items[this.position].target);this.hotspots.attr("title",this.items[this.position].title);n=function(){var e,n,r,i;r=this.items;i=[];e=0;for(n=r.length;e<n;e++){t=r[e];i.push(t.width)}return i}.call(this);n=_.reduce(n,function(e,t){return e+t});this.parent.width(n);this.center();this.cycle_start();return this.hotspot_container.css({left:this.window_width/2-this.hotspot_container.width()})};t.prototype.ie=function(){this.ie7=true;this.shim=$("#feature-nav-shim");return this.shim.css({left:this.window_width/2-this.shim.width()/2})};t.prototype.cycle_start=function(){if(this.cycle_state=true)return this.cycle_interval=window.setInterval(this.cycle_loop,this.animation_pause)};t.prototype.cycle_loop=function(){if(this.cycle_state)return this.cycle()};t.prototype.cycle_stop=function(){this.cycle_state=false;return window.clearInterval(this.cycle_interval)};t.prototype.cycle=function(){return this.cycle_state?this.increment():false};t.prototype.increment=function(){if(this.position===this.items.length-1){this.loop_increment();this.clear_nav();this.items[this.position].toggle();return this.center()}else{this.position+=1;this.center();this.clear_nav();return this.items[this.position].toggle()}};t.prototype.decrement=function(){if(this.position===0){this.loop_decrement();this.clear_nav();this.items[this.position].toggle();return this.center()}else{this.position-=1;this.center();this.clear_nav();return this.items[this.position].toggle()}};t.prototype.loop_increment=function(){var e;e=this.items.shift();this.items.push(e);return this.reorder_images((this.parent.width()-e.width*2)*-1+(this.window_width-e.width)/2)};t.prototype.loop_decrement=function(){var e;e=this.items.pop();this.items.unshift(e);return this.reorder_images(e.width*-1+(this.window_width-e.width)/2)};t.prototype.reorder_images=function(e){var t;this.parent.html("");for(t in this.items)this.parent.append(this.items[t].el);return this.parent.css("margin-left",e+"px")};t.prototype.center=function(){var e,t,n;if(this.position===0)e=n=0;else{n=function(){var e,n,r,i;r=this.items.slice(0,this.position-1+1||9e9);i=[];e=0;for(n=r.length;e<n;e++){t=r[e];i.push(t.width)}return i}.call(this);e=_.reduce(n,function(e,t){return e+t})}n=this.window_width/2;e+=this.items[this.position].midpoint;this.clear_nav();this.items[this.position].toggle();jQuery.easing.def=this.easing;this.parent.animate({"margin-left":e*-1+n},this.animation_time);this.hotspot.attr("href",this.items[this.position].target);this.hotspots.attr("title",this.items[this.position].title);if(this.ie7){n=this.position===0?this.window_width/2-this.shim.width()/2:e-this.shim.width()/2;return this.shim.animate({left:n},600)}};t.prototype.clear_nav=function(){var e;e=/feature_nav_on/g;return _.each(this.items,function(t){var n;n=t.nav_el.attr("src");n=n.replace(e,"feature_nav_off");return t.nav_el.attr({src:n})})};t.prototype.recalc=function(){this.window_width=$(window).width();return this.center()};return t}();i=function(){return function(e,t,n){this.el=e;this.features=t;this.direction=n;this.el=$(this.el);this.el.click(o(function(e){e.preventDefault();this.features.cycle_state=false;if(this.direction==="left")return this.features.increment();else if(this.direction==="right")return this.features.decrement()},this))}}();r=function(){function e(e){var t;this.class_name=e;this.mobile=false;this.spotlights=$(this.class_name);this.items=[];t=this;_.each(["iPhone","iPod","iPad","Android","webOS","BlackBerry","Windows Phone"],function(e){if(navigator.userAgent.match(RegExp(e,"i"))){t.mobile=true;return $(".overlay-close").css({display:"block"})}});this.spotlights.each(o(function(e,t){return this.items.push(new n(t,this))},this));_.each(this.items,function(e){e.mobile=t.mobile;e.el.mouseenter(function(){e.show();return e.features_collection.cycle_stop()});return e.el.mouseleave(function(){e.start_count();return e.features_collection.cycle_start()})})}e.prototype.clear=function(){return _.each(this.items,function(e){return e.hide()})};e.prototype.recalc=function(){var e;e=($(window).width()-$("#features").width())/2;return _.each(this.items,function(t){t.left=e;return t.overlay.css({left:e})})};e.prototype.register_features=function(e){return _.each(this.items,function(t){return t.features_collection=e})};return e}();n=function(){function e(e,t){this.el=e;this.parent=t;this.check_state=o(this.check_state,this);this.el=$(this.el);this.id=this.el.attr("id");this.left=($(window).width()-$("#features").width())/2;this.overlay=$("#overlay-"+this.suffix);this.overlay.css({left:this.left});this.state=0;this.overlay.find(".overlay-close a").click(o(function(e){e.preventDefault();return this.hide()},this))}e.prototype.show=function(){this.parent.clear();this.overlay.fadeIn("fast");this.state=0;this.overlay.mouseenter(o(function(){return this.state=1},this));return this.overlay.mouseleave(o(function(){return this.hide()},this))};e.prototype.hide=function(){this.overlay.fadeOut("fast");return this.state=0};e.prototype.check_state=function(){if(this.state===0)return this.hide()};e.prototype.start_count=function(){return window.setTimeout(this.check_state,1e3)};return e}();s=typeof exports!=="undefined"&&exports!==null?exports:this;s.Features=t;s.Trigger=i;s.Spotlights=r}).call(this)